\section{Appendix}
\input{list-code}
\begin{lemma} [\bfseries Unique External Locus]
Every version $v$ (except the \C{INIT} version) in the history $H$
generated by the rules in Fig.~\ref{fig:opsem} has a unique external
locus.
\end{lemma}
\begin{proof}
By case analysis on the reduction relation. In each case, we assume
that the unique external locus property holds for the initial history,
and prove that it holds for the final history.

In \rulelabel{E-Run} case, initial version is the unique external locus of
the new version on the new branch $H(t)$. In \rulelabel{E-Fork} case,
which creates the branch $H(t')$ by forking from $H(t)$, the latest
version on $H(t)$ is the external locus of the first version on
$H(t)$. In \rulelabel{E-Push} case, the version on $H(t)$ has the same
external locus as the previous latest version, which, premise says, is
unique. No new version is created in \rulelabel{E-Pull}. In
\rulelabel{E-Pull-Wait}, new version is created by merging the latest
version ($v'$) on $H(t')$ into the latest version $v$ on $H(t)$.
Premise says that $v$ has a unique external locus (call it $v_o$). The
new version $v_m$ inherits $v_o$ as a least external ancestor, and
also has $v'$ as another least external ancestor. However, since
$\under{H}{v' \mbleto v}$, we have $\under{H}{v_o \preceq v'}$, we
have $v'$ as the the external locus.
\qed
\end{proof}

\begin{lemma} [\bfseries Unique LCA]
Every pair of versions $v_1$ and $v_2$ in the history $H$ generated by
the rules in Fig.~\ref{fig:opsem} have a unique least
common ancestor. 
\end{lemma}
\begin{proof}
By case analysis on the step relation. In each case, we assume that
the unique LCA property holds for the initial history, and prove that
it holds for the final history.

The \rulelabel{E-Run} case is trivial. The \rulelabel{E-Push} case
creates a new version ($v$) with \C{PUSH} tag at the end of a branch.
Let $v_1$ be the previous version on the branch, and let $v_2$ be any
other version. The premise is that $v_1$ and $v_2$ have a unique LCA
$v_0$. Observe that $v$'s internal locus is $v_1$ and its external
locus is same as that of $v_1$. Hence, all ancestors of $v_1$
(including itself) are also ancestors of $v$. Moreover, $v$ has no new
ancestors except itself, which is the latest version being added.
Hence, any common ancestor of $v_1$ and $v_2$ is also a common
ancestor of $v$ and $v_2$, while there cannot be new common ancestors.
Hence LCA of $v$ and $v_2$ is unique. The reasoning for
\rulelabel{E-Fork} is similar. The \rulelabel{E-Pull} case is trivial. 

The \rulelabel{E-Pull-Wait} case is where the merge happens. Version
$v'$ is merging into version $v$ to produce the next version $v_m$.
Let $v_2$ be any version. From the premise, we know that $v$ and $v_2$
have a unique LCA (call it $v_0$), and $v'$ and $v_2$ have a unique
LCA (call it $v_1$). But, we know that $v_2$ has a unique external
locus (call it $v_3$), hence we know that 
\begin{itemize}
  \item Both $v_0$ and $v_1$ are external ancestors of $v_2$. Hence,
  $\under{H}{v_0 \preceq v_3} \conj \under{H}{v_1 \preceq v_3}$.
  Since $\under{H}{v_0 \preceq v_m} \conj \under{H}{v_1 \preceq v_m}$, 
  $v_2$ and $v_m$ have a unique LCA.

  \item $v_0$ is an internal ancestor of $v_2$, hence an external
  ancestor of $v$, hence an external ancestor of $v_m$. $v_1$ is
  an ancestor of $v'$, hence also an external ancestor of $v_m$. 
\end{itemize}
\end{proof}




